---
title: factory
description: アプリケーションのファクトリ関数を提供する。
---

## `create_app(import_name: str) -> Flask`
アプリケーションファクトリ関数。  

#### オーバーロード
- `create_app(import_name: str, config_path: str) -> Flask`  
- `create_app(import_name: str, config: RuntimeConfig) -> Flask`

#### 引数

| 名前        | 型                                            | 説明                                       |
| ----------- | --------------------------------------------- | ------------------------------------------ |
| import_name | str                                           | Flaskアプリケーションのインポート名        |
| config_path | str                                           | （オーバーロード）設定ファイルのパス       |
| config      | [RuntimeConfig](./02.config.md#runtimeconfig) | （オーバーロード）サーバー設定インスタンス |

#### 戻り値

| 型    | 説明                                          |
| ----- | --------------------------------------------- |
| Flask | 初期化されたFlaskアプリケーションインスタンス |

#### 処理概要
1. 引数 `import_name` を使用してFlaskアプリケーションインスタンスを生成する。
2. Flask拡張 [`JAIROCloudGroupsManager`](./05.ext.md#jairocloudgroupsmanager) をアプリケーションインスタンスで初期化する。
  このとき、引数 `config_path` または `config` を渡す。
1. [`celery_init_app`](#celery_init_appapp-flask-celery) を呼び出し、Celeryアプリケーションを初期化する。
2. 初期化されたFlaskアプリケーションインスタンスを返す。


## `celery_init_app(app: Flask) -> Celery`
Cleryアプリケーションを生成するファクトリ関数。Flask拡張として初期化を行う。

#### 引数

| 名前 | 型    | 説明                              |
| ---- | ----- | --------------------------------- |
| app  | Flask | Flaskアプリケーションインスタンス |

#### 戻り値

| 型     | 説明                               |
| ------ | ---------------------------------- |
| Celery | Celeryアプリケーションインスタンス |

#### 依存するライブラリ
- Celery: 非同期タスク管理に使用する。

#### 処理概要
1. Celeryアプリケーションを生成する。このとき、タスクがFlaskアプリケーションのコンテキスト内で実行されるように設定する。
2. 引数 `app` から設定値 `CELERY` を取得し、Celeryアプリケーションに設定に登録する。
3. Flask拡張にCeleryアプリケーションを登録する。
4. 初期化済みのCeleryアプリケーションインスタンスを返却する。
